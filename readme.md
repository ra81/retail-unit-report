# retailUnitReport

## ВАЖНО
- Если у вас есть другие скрипты изменяющие данные окна, то может работать некорректно. Алгоритм привязывается к 
расположению элементов по номерам в некоторых случаях, поэтому будет считывать другие данные.
- Не обсчитывает брендовые товары, так как по ним нельзя взять объем рынка.

## УСТАНОВКА
Зайдите в папку `retailUnitReport/out` и кликайте на `retailUnitReport.user.js` после чего кликайте на кнопку raw. Скрипт будет установле. При обновлении тамперманки его автоматом обновит у вас в браузере.

## Для чего?
Для игры виртономика. Это пользовательский скрипт. Написан на TypeScript и скомпилирован в JavaScript. Тестировался и проверялся на TamperMonkey.
Основное предназначение для отслеживания чужих магазинов на текущую выручку, на основные доходные позиции товара и на потенциальный рост продаж. Обычно это нужно в конкурсах.

## Что делает?
Если вы зашли на страницу чужого юнита относящегося к рознице (магазин или заправка) то выводит:
- по каждому товару который есть в магазине оранжевым цветом примерная общая выручка
- дополнительно серым цветом выводится выручка которая будет если по текущей цене продать 100% рынка
- в шапке страницы выводит консолидированные цифры по текущей выручке и потенциальной при занятии рынка на 100%
- добавляет кнопку, по которой можно запросить уточненные данные по выручке для каждого товара и консолидированным данным

Основная проблема приближенной оценки в том что игра выдает грубые числа. около 10 000, около 100 000, около 500 000. У нее слишком большой шаг. И для погрешность может быть ощутимой. Для этого и создана кнопка уточнения.

Если вы нажали на кнопку Обновить, тогда происходит следующая операция:
- скрипт запрашивает для каждого товара, для города в котором стоит магазин текущий объем рынка в штуках товара
- берет долю рынка для магазина по товару в % и используя ее вычисляет реальное число проданных штук товара.
- зная реальное число, легко вычисляется реальная выручка.
- далее все суммируется и выводится в шапку. Для каждого товара число тоже обновляется.
- в случае каких либо ошибок, будет сообщение под кнопкой с информацией об ошибке.

Уточненная информация тоже имеет погрешнность в 0.01% от объема рынка для товара в данном городе. Если объем рынка очень велик, то там могут быть 100 штук погрешность, обычно же там очень маленькая ошибка.
